<!DOCTYPE html>
<html lagn="ko" xmlns:th="http://www.thymeleaf.org" xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout">

<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0, user-scalable=no"/>
  <title>제조기록서</title>

  <meta name="msapplication-TileColor" content="#ffffff">
  <meta name="theme-color" content="#ffffff">

  <link rel="stylesheet" href="/css/desktop_2.css"/>
  <link rel="stylesheet" href="/css/custom_2.css"/>

  <script src="/js/jquery.min.js"></script>
  <script src="/js/temp.js"></script>

  <script src="/js/xlsx.full.min.js"></script>
  <script src="/js/tui-grid.js"></script>
  <link rel="stylesheet" href="/css/tui-grid.css"/>
  <script src="/js/desktop.js"></script>

  <script src="/js/common.js"></script>

  <script src="https://cdn.tiny.cloud/1/9hwtzxtc2zwisi7b85nco60f3mzb63hrh69z1w3qywn28snr/tinymce/7/tinymce.min.js" referrerpolicy="origin"></script>

  <style>
      .chan-blue > div {
          color: blue !important;
          text-decoration: underline;
          cursor: pointer;
      }

      #detailTiny * {
          all: revert-layer;
      }
  </style>
</head>

<body>
<div class="container is-header">
  <!-- nav -->
  <!-- [ Header ] start -->
  <nav class="navbar" role="navigation" aria-label="main navigation">
    <div class="navbar-logo">
      <a class="navbar-link" href="javascript:void(0);" rel="noopener" onclick="loadPage('none')">
        <span class="logo is-gsitm-hr is-medium">
          <img src="img/svg/logo-kgc.svg"/>
        </span>
      </a>
    </div>
    <div class="navbar-menu">
      <ul class="navbar-left" id="headerMenu">
        <li class="navbar-item" data-target="dom">
          <a class="navbar-link" href="javascript:void(0);" aria-current="page" rel="noopener">
            <span class="icon is-person-check is-medium">
              <svg id="svgClipboard"><use href="#clipboard"></use></svg>
            </span>
            <span>문서관리</span>
          </a>
        </li>
        <li class="navbar-item" data-target="com">
          <a class="navbar-link" href="javascript:void(0);" aria-current="page" rel="noopener">
            <span class="icon is-person-check is-medium">
              <svg id="svgWindowGear"><use href="#window-gear"></use></svg>
            </span>
            <span>공통관리</span>
          </a>
        </li>
      </ul>
      <ul class="navbar-right">
        <li class="navbar-item">
          <a class="navbar-link" id="btnsiteMap" href="javascript:void(0);" aria-current="page" rel="noopener"></a>
        </li>
        <li class="navbar-item">
          <a class="navbar-link" id="headerEmplSearch" href="javascript:void(0);" aria-current="page" rel="noopener">
            <div class="control is-x-large has-icon-right" style="width: 150px;">
              <input id="inputEmplSearch" type="text" th:placeholder="사원검색" class="input" disabled/>
              <span class="icon is-search is-large">
                  <svg id="svgSearch"><use href="#search"></use></svg>
              </span>
            </div>
          </a>
        </li>
        <li class="navbar-item">
          <a class="navbar-link" href="javascript:void(0);" aria-current="page" rel="noopener">
            <span class="icon is-logout is-medium">
                <svg id="svgLogout"><use href="#logout"></use></svg>
            </span>
          </a>
        </li>
      </ul>
    </div>
  </nav>
  <!-- [ Header ] end -->

  <!-- side -->
  <div class="container is-page" id="mainBody">
    <div class="columns is-page">
      <!-- [ navigation menu ] start -->
      <aside class="left-navbar is-active">
        <button class="lnb-toggle-btn is-active">LNB 접기/펼치기</button>
        <div class="profile">
          <div class="columns">
            <figure id="_psmstrPhotoPicture" class="id-photo">
              <img id="_psmstrPhotoImg" src="/img/jpg/user-photo-default@2x.jpg" alt="사용자 사진" class="profile-photo"/>
            </figure>
            <div class="profile-content">
              <p class="profile-personnel">
                <span id="_profile_userNm" class="profile-name">테스트</span>
                <span id="_profile_posiNm" class="profile-position">관리자</span>
                <button id="btnProfileSetting" class="button is-setting is-ghost">
                  <span class="icon is-setting is-filled is-white is-medium">
                    <svg id="svgSettingsFilled"><use href="#settings-filled"></use></svg>
                  </span>
                </button>
              </p>
              <p class="profile-personnel">
                <span class="profile-id" id="_profile_userId">testId</span>
                <span class="profile-divider">|</span>
                <span class="profile-team" id="_profile_deptNm">인사팀</span>
              </p>
              <p id="_profile_emailAd" class="profile-email" style="font-size: smaller;"></p>
            </div>
          </div>
          <div class="field">
            <div class="control is-x-large has-icon-right">
              <input id="menuSearch" type="text" th:placeholder="메뉴검색" class="input" autocomplete="off" disabled/>
              <span class="icon is-search is-large">
                <svg id="svgSearch_2"><use href="#search"></use></svg>
              </span>
              <ul class="search-result"></ul>
            </div>
          </div>
        </div>
        <ul class="tabs is-menu">
          <li class="tab is-active" data-target="base">
            <a class="tab-link" href="javascript:void(0);" rel="noopener">
              <span class="icon is-medium is-menu">
                <svg id="svgMenu"><use href="#menu"></use></svg>
              </span>
              <span>메뉴</span>
            </a>
          </li>
          <li class="tab" data-target="fav">
            <a class="tab-link" href="javascript:void(0);" rel="noopener">
              <span class="icon is-medium is-menu">
                <svg id="svgStar"><use href="#star"></use></svg>
              </span>
              <span>즐겨찾기</span>
            </a>
          </li>
        </ul>
        <div class="tab-contents is-menu">
          <div class="tab-content is-menu is-active">
            <ul id="sideMenuDoc" class="menu" style="display: none;">
              <li class="menu-item">
                <a class="menu-link" href="javascript:void(0);" aria-current="page" rel="noopener" onclick="loadPage('list')">
                  제조기록서
                </a>
              </li>
              <li class="menu-item">
                <a class="menu-link" href="javascript:void(0);" aria-current="page" rel="noopener" onclick="loadPage('formList')">
                  제조기록서 양식
                </a>
              </li>
              <li class="menu-item">
                <a class="menu-link" href="javascript:void(0);" aria-current="page" rel="noopener" onclick="loadPage($(this).text())">
                  샘플메뉴_1
                </a>
              </li>
            </ul>
            <ul id="sideMenuCom" class="menu" style="display:none;">
              <li class="menu-item">
                <a class="menu-link" href="javascript:void(0);" aria-current="page" rel="noopener" onclick="loadPage($(this).text())">
                  샘플메뉴_2
                </a>
              </li>
              <li class="menu-item">
                <a class="menu-link" href="javascript:void(0);" aria-current="page" rel="noopener">
                  샘플메뉴_3
                  <ul class="sub-menu">
                    <li class="sub-menu-item">
                      <a class="sub-menu-link" href="javascript:void(0);" rel="noopener" onclick="loadPage($(this).text())">샘플하위메뉴_1</a>
                    </li>
                    <li class="sub-menu-item">
                      <a class="sub-menu-link" href="javascript:void(0);" rel="noopener" onclick="loadPage($(this).text())">샘플하위메뉴_2</a>
                    </li>
                    <li class="sub-menu-item">
                      <a class="sub-menu-link" href="javascript:void(0);" rel="noopener" onclick="loadPage($(this).text())">샘플하위메뉴_3</a>
                    </li>
                  </ul>
                </a>
              </li>
              <li class="menu-item">
                <a class="menu-link" href="javascript:void(0);" aria-current="page" rel="noopener" onclick="loadPage($(this).text())">
                  샘플메뉴_4
                </a>
              </li>
            </ul>
            <ul id="sideMenuFav" class="menu" style="display: none;">
            </ul>
          </div>
          <div class="tab-content is-favorite">
            <ul id="favoriteMenu" class="favorite"></ul>
          </div>
        </div>
      </aside>
      <div class="page" id="mainContent">
        <!-- 메인 페이지 시작... -->
        <!-- 0(S) -->
        <div class="content" id="formListForm" style="display: none;">
          <div class="page is-main">
            <div class="page-body">
              <div class="card is-sub is-search">
                <div class="card-header">
                  <h1 class="page-title">
                    제조기록서 양식
                    <div class="columns">
                      <ul aria-label="breadcrumbs" class="breadcrumbs has-chevron-separator">
                        <li class="breadcrumb">
                          <span>홈</span>
                        </li>
                        <li aria-current="page" class="breadcrumb is-active">
                          <a href="javascript:void(0);" rel="noopener">제조기록서 양식</a>
                        </li>
                      </ul>
                      <label class="checkbox is-star">
                        <input type="checkbox"/>
                        <span class="icon is-star is-large">
                          <svg><use href="#star"></use></svg>
                        </span>
                        <div class="tooltip">즐겨찾기</div>
                      </label>
                      <button class="button is-question is-ghost">
                        <span class="icon is-question is-filled is-medium">
                          <svg><use href="#question-filled"></use></svg>
                        </span>
                        <div class="tooltip">도움말</div>
                      </button>
                    </div>
                  </h1>
                </div>
                <div class="card-body">
                  <table class="table is-search is-fullwidth">
                    <colgroup>
                      <col style="width: 9%;"/>
                      <col/>
                      <col style="width: 9%;"/>
                      <col/>
                      <col style="width: 9%;"/>
                      <col/>
                      <col style="width: 7.4%;"/>
                    </colgroup>
                    <tbody>
                    <tr>
                      <th><span>일자</span></th>
                      <td>
                        <input type="text" class="input" disabled/>
                      </td>
                      <th><span>공정(제조공정)</span></th>
                      <td>
                        <input type="text" class="input" id="formListProcessName"/>
                      </td>
                      <th></th>
                      <td></td>
                      <td rowspan="2">
                        <button type="button" class="button is-search is-filled is-medium" id="searchFormListForm">
                            <span class="icon is-search is-medium">
                                <svg><use href="#search"></use></svg>
                            </span>
                          <span>조회</span>
                        </button>
                      </td>
                    </tr>
                    <tr>
                      <th><span>제조번호</span></th>
                      <td>
                        <input type="text" class="input" id="formListLotNo"/>
                      </td>
                      <th><span>품목(제품명)</span></th>
                      <td>
                        <input type="text" class="input" id="formListProductName"/>
                      </td>
                      <th></th>
                      <td></td>
                    </tr>
                    </tbody>
                  </table>
                </div>
              </div>

              <div class="card is-sub">
                <div class="card-body">
                  <div class="columns has-gap">
                    <div class="column">
                      <div class="form" id="list_2GridParent">
                        <div class="columns has-table-title">
                          <h2 class="table-title">
                            <span>제조기록서 양식</span>
                            <span class="data-count"><span>3</span>건</span>
                          </h2>
                        </div>
                        <div id="list_2Grid"></div>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
        <!-- 0(E) -->

        <!-- 1(S) -->
        <div class="content" id="listForm" style="display: none;">
          <div class="page is-main">
            <div class="page-body">
              <div class="card is-sub is-search">
                <div class="card-header">
                  <h1 class="page-title">
                    제조기록서
                    <div class="columns">
                      <ul aria-label="breadcrumbs" class="breadcrumbs has-chevron-separator">
                        <li class="breadcrumb">
                          <span>홈</span>
                        </li>
                        <li aria-current="page" class="breadcrumb is-active">
                          <a href="javascript:void(0);" rel="noopener">제조기록서</a>
                        </li>
                      </ul>
                      <label class="checkbox is-star">
                        <input type="checkbox"/>
                        <span class="icon is-star is-large">
                          <svg><use href="#star"></use></svg>
                        </span>
                        <div class="tooltip">즐겨찾기</div>
                      </label>
                      <button class="button is-question is-ghost">
                        <span class="icon is-question is-filled is-medium">
                          <svg><use href="#question-filled"></use></svg>
                        </span>
                        <div class="tooltip">도움말</div>
                      </button>
                    </div>
                  </h1>
                </div>
                <div class="card-body">
                  <table class="table is-search is-fullwidth">
                    <colgroup>
                      <col style="width: 9%;"/>
                      <col/>
                      <col style="width: 9%;"/>
                      <col/>
                      <col style="width: 9%;"/>
                      <col/>
                      <col style="width: 7.4%;"/>
                    </colgroup>
                    <tbody>
                    <tr>
                      <th><span>등록일자</span></th>
                      <td>
                        <input type="text" class="input" disabled/>
                      </td>
                      <th><span>공정번호</span></th>
                      <td>
                        <input type="text" class="input"/>
                      </td>
                      <th></th>
                      <td></td>
                      <td rowspan="2">
                        <button type="button" class="button is-search is-filled is-medium" disabled>
                            <span class="icon is-search is-medium">
                                <svg><use href="#search"></use></svg>
                            </span>
                          <span>조회</span>
                        </button>
                      </td>
                    </tr>
                    <tr>
                      <th><span>제조번호</span></th>
                      <td>
                        <input type="text" class="input"/>
                      </td>
                      <th><span>품목</span></th>
                      <td>
                        <input type="text" class="input"/>
                      </td>
                      <th></th>
                      <td></td>
                    </tr>
                    </tbody>
                  </table>
                </div>
              </div>

              <div class="card is-sub">
                <div class="card-body">
                  <div class="columns has-gap">
                    <div class="column">
                      <div class="form" id="listGridParent">
                        <div class="columns has-table-title">
                          <h2 class="table-title">
                            <span>제조기록서</span>
                            <span class="data-count"><span id="listGridCnt">0</span>건</span>
                          </h2>
                          <div class="buttons">
                            <button id="btnListWrite" type="button" class="button is-outline is-primary is-medium" style="margin-right: 10px;">
                              제조기록서 작성
                            </button>
                          </div>
                        </div>
                        <div id="listGrid"></div>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
        <!-- 1(E) -->

        <!-- 2(S) -->
        <div class="content" id="emptyForm" style="display: none;">
          <div class="page is-main">
            <div class="page-body">
              <div class="card is-sub is-search">
                <div class="card-header">
                  <h1 class="page-title" id="emptyTitle">빈페이지</h1>
                </div>
                <div class="card-body">
                  <table class="table is-search is-fullwidth">
                    <colgroup>
                      <col style="width: 9%;"/>
                      <col/>
                      <col style="width: 9%;"/>
                      <col/>
                      <col style="width: 9%;"/>
                      <col/>
                      <col style="width: 7.4%;"/>
                    </colgroup>
                    <tbody>
                    <tr>
                      <th><span>검색조건1</span></th>
                      <td>
                        <input type="text" class="input"/>
                      </td>
                      <th><span>검색조건2</span></th>
                      <td>
                        <input type="text" class="input"/>
                      </td>
                      <th></th>
                      <td></td>
                      <td rowspan="2">
                        <button type="button" class="button is-search is-filled is-medium" disabled>
                            <span class="icon is-search is-medium">
                                <svg><use href="#search"></use></svg>
                            </span>
                          <span>조회</span>
                        </button>
                      </td>
                    </tr>
                    <tr>
                      <th><span>검색조건3</span></th>
                      <td>
                        <input type="text" class="input"/>
                      </td>
                      <th><span>검색조건4</span></th>
                      <td>
                        <input type="text" class="input"/>
                      </td>
                      <th></th>
                      <td></td>
                    </tr>
                    </tbody>
                  </table>
                </div>
              </div>

              <div class="card is-sub">
                <div class="card-body">
                  <div class="columns has-gap">
                    <div class="column">
                      <div class="form">
                        <div class="columns has-table-title">
                          <h2 class="table-title">
                            <span>검색결과</span>
                            <span class="data-count"><span>x</span>건</span>
                          </h2>
                        </div>
                        <div></div>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
        <!-- 2(E) -->

        <!-- 4(S) -->
        <div class="content" id="updateForm" style="display: none;">
          <div class="page is-main">
            <div class="page-body">
              <div class="card is-sub is-search" style="padding: 0 5rem 5rem 15rem">
                <div class="card-header">
                  <h1 class="page-title">
                    제조기록서 양식 수정
                    <div class="columns">
                      <ul aria-label="breadcrumbs" class="breadcrumbs has-chevron-separator">
                        <li class="breadcrumb">
                          <span>홈</span>
                        </li>
                        <li aria-current="page" class="breadcrumb">
                          <a href="javascript:void(0);" rel="noopener" onclick="loadPage('formList')">제조기록서양식</a>
                        </li>
                      </ul>
                    </div>
                  </h1>
                </div>
              </div>

              <div class="card is-sub">
                <div class="card-body">
                  <div class="columns has-gap">
                    <div class="column">
                      <div class="form">
                        <div class="columns has-table-title">
                          <h2 class="table-title">
                            <span>양식</span>
                          </h2>
                          <div class="buttons">
                            <button id="btnUpdate" type="button" class="button is-outline is-primary is-medium" style="margin-right: 10px;">
                              수정하기
                            </button>
                          </div>
                        </div>
                        <div id="updateTiny"></div>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
        <!-- 4(E) -->

        <!-- 5(S) -->
        <div class="content" id="writeForm" style="display: none;">
          <div class="page is-main">
            <div class="page-body">
              <div class="card is-sub is-search" style="padding: 0 5rem 5rem 15rem">
                <div class="card-header">
                  <h1 class="page-title">
                    <div id="writeFormTitle">제조기록서 작성</div>
                    <div class="columns">
                      <ul aria-label="breadcrumbs" class="breadcrumbs has-chevron-separator">
                        <li class="breadcrumb">
                          <span>홈</span>
                        </li>
                        <li aria-current="page" class="breadcrumb">
                          <a href="javascript:void(0);" rel="noopener" onclick="loadPage('list')">제조기록서</a>
                        </li>
                      </ul>
                    </div>
                  </h1>
                </div>
              </div>

              <div class="card is-sub">
                <div class="card-body">
                  <div class="columns has-gap">
                    <div class="column">
                      <div class="form">
                        <div class="columns has-table-title">
                          <h2 class="table-title">
                            <span>양식</span>
                          </h2>
                          <div class="buttons">
                            <button id="btnWrite" type="button" class="button is-outline is-primary is-medium" style="margin-right: 10px;">
                              작성하기
                            </button>
                            <button id="btnWriteUpdate" type="button" class="button is-outline is-primary is-medium" style="margin-right: 10px;">
                              수정하기
                            </button>
                          </div>
                        </div>
                        <div id="writeTiny"></div>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
        <!-- 5(E) -->

        <!-- 6(S) -->
        <div class="content" id="detailForm" style="display: none;">
          <div class="page is-main">
            <div class="page-body">
              <div class="card is-sub is-search" style="padding: 0 5rem 5rem 15rem">
                <div class="card-header">
                  <h1 class="page-title">
                    <div id="detailTitle">제조기록서 상세</div>
                    <div class="columns">
                      <ul aria-label="breadcrumbs" class="breadcrumbs has-chevron-separator">
                        <li class="breadcrumb">
                          <span>홈</span>
                        </li>
                        <li aria-current="page" class="breadcrumb">
                          <a href="javascript:void(0);" rel="noopener" id="detailFormBread" onclick="loadPage('formList')" style="display: none;">제조기록서
                            양식</a>
                          <a href="javascript:void(0);" rel="noopener" id="detailListBread" onclick="loadPage('list')" style="display: none;">제조기록서</a>
                        </li>
                      </ul>
                    </div>
                  </h1>
                </div>
              </div>

              <div class="card is-sub" style="padding: 0">
                <div style="margin: 37rem 32rem 46rem; overflow-x: auto;">
                  <div class="card-body">
                    <div class="columns">
                      <div class="column">
                        <div class="form" style="justify-self: center;">
                          <div class="columns has-table-title">
                            <h2 class="table-title">
                              <span></span>
                            </h2>
                            <div class="buttons">
                              <button id="btnDownPdf" class="button is-outline is-primary is-medium">
                                <span class="icon is-medium" style="padding-right: 5px;">
                                  <svg id="svgPdf" width="15" height="15" viewBox="0 0 64 64" xmlns="http://www.w3.org/2000/svg">
                                    <rect x="8" y="4" width="48" height="56" rx="4" ry="4" fill="#FFFFFF" stroke="#000000" stroke-width="2"/>
                                    <rect x="8" y="24" width="48" height="24" fill="#D32F2F"/>
                                    <text x="16" y="40" font-family="Arial, sans-serif" font-size="16" fill="#FFFFFF" font-weight="bold">PDF</text>
                                  </svg>
                                </span>
                                <span>PDF다운</span>
                              </button>
                              <button id="btnDetailWrite" type="button" class="button is-outline is-primary is-medium">
                                기록서 수정
                              </button>
                              <button id="btnDetailUpdate" type="button" class="button is-outline is-primary is-medium">
                                양식 수정
                              </button>
                            </div>
                          </div>
                          <div id="detailTiny"></div>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
        <!-- 6(E) -->

        <!-- 7(S) -->
        <div class="content" id="mainForm">
          <div class="page is-main">
            <div class="page-body">
              <div class="columns has-gap is-wrapped">
                <div class="column is-half is-grown-vertically">
                  <div class="card is-main has-tabs is-grown-vertically">

                    <header class="card-header">
                      <ul class="tabs is-underline">
                        <li class="tab is-active">
                          <a href="#none" rel="noopener">
                            <p><span>작성중</span>(<span id="status1">0</span>)</p>
                          </a>
                        </li>
                        <li class="tab">
                          <a href="#none" rel="noopener">
                            <p>
                              <span>결재중</span>(<span id="status2">0</span>)
                            </p>
                          </a>
                        </li>
                        <li class="tab">
                          <a href="#none" rel="noopener">
                            <p>
                              <span>결재완료</span>(<span id="status3">0</span>)
                            </p>
                          </a>
                        </li>
                        <li class="tab">
                          <a href="#none" rel="noopener">
                            <p>
                              <span>결재할문서</span>(<span id="status4">0</span>)
                            </p>
                          </a>
                        </li>
                      </ul>
                      <button class="button is-refresh is-ghost" aria-label="refresh" id="btnRefresh">
                        <span class="icon is-refresh">
                          <svg>
                            <use href="#refresh"></use>
                          </svg>
                        </span>
                      </button>
                    </header>

                    <div class="card-body">
                      <div class="tab-contents is-underline">
                        <div class="tab-content is-active" id="documentStatus1">
                          <table class="table has-no-borders is-fullwidth">
                            <colgroup>
                              <col style="width: 74%"></col>
                              <col style="width: 12%"></col>
                              <col></col>
                            </colgroup>
                            <tbody>
                            <tr>
                              <td colspan="3">데이터가 없습니다.</td>
                            </tr>
                            </tbody>
                          </table>
                        </div>
                        <div class="tab-content" id="documentStatus2">
                          <table class="table has-no-borders is-fullwidth">
                            <colgroup>
                              <col style="width: 74%"></col>
                              <col style="width: 12%"></col>
                              <col></col>
                            </colgroup>
                            <tbody>
                            <tr>
                              <td colspan="3">데이터가 없습니다.</td>
                            </tr>
                            </tbody>
                          </table>
                        </div>
                        <div class="tab-content" id="documentStatus3">
                          <table class="table has-no-borders is-fullwidth">
                            <colgroup>
                              <col style="width: 74%"></col>
                              <col style="width: 12%"></col>
                              <col></col>
                            </colgroup>
                            <tbody>
                            <tr>
                              <td colspan="3">데이터가 없습니다.</td>
                            </tr>
                            </tbody>
                          </table>
                        </div>
                        <div class="tab-content" id="documentStatus4">
                          <table class="table has-no-borders is-fullwidth">
                            <colgroup>
                              <col style="width: 74%"></col>
                              <col style="width: 12%"></col>
                              <col></col>
                            </colgroup>
                            <tbody>
                            <tr>
                              <td colspan="3">데이터가 없습니다.</td>
                            </tr>
                            </tbody>
                          </table>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>

                <div class="column is-half is-grown-vertically">
                  <div class="columns has-gap is-wrapped">
                    <div class="column is-fullwidth">
                      <div class="card is-main has-table is-main-notice">
                        <div class="card-header">
                          <h2 class="card-title">공지사항</h2>
                          <a class="button is-more is-ghost" href="javascript:void(0);">
                            <span class="icon is-chevron-right"><svg><use href="#chevron-right"></use></svg></span>
                          </a>
                        </div>
                        <section class="card-body" id="noticeList">
                          <div class="no-result" id="notiNoResult">
                            <p></p>
                            <p>공지내용이 없습니다.</p>
                            <p></p>
                          </div>
                        </section>
                      </div>
                    </div>
                    <div class="column is-fullwidth">
                      <div class="card is-main is-quick-menu">
                        <section class="card-body">
                          <div class="columns has-gap is-wrapped">
                            <a class="column" href="javascript:void(0);">
                              <span class="icon is-parasol"><svg><use href="#parasol"></use></svg></span>
                              <span>휴가</span>
                            </a>
                            <a class="column" href="javascript:void(0);">
                              <span class="icon is-calendar-x"><svg><use href="#calendar-x"></use></svg></span>
                              <span>휴가취소</span>
                            </a>
                            <a class="column" href="javascript:void(0);">
                              <span class="icon is-suitcase"><svg><use href="#suitcase"></use></svg></span>
                              <span>파견</span>
                            </a>

                            <a class="column" href="javascript:void(0);">
                              <span class="icon is-clock"><svg><use href="#clock"></use></svg></span>
                              <span>연장근무</span>
                            </a>
                            <a class="column" href="javascript:void(0);">
                              <span class="icon is-clipboard-check"><svg><use href="#clipboard-check"></use></svg></span>
                              <span>문서발급</span>
                            </a>
                            <a class="column" href="javascript:void(0);">
                              <span class="icon is-address-book"><svg><use href="#address-book"></use></svg></span>
                              <span>인적정보</span>
                            </a>
                            </a>
                          </div>
                        </section>
                      </div>
                    </div>
                  </div>
                </div>

                <div class="column is-half is-grown-vertically">
                  <div class="columns has-gap is-wrapped">
                    <div class="column is-half is-grown-vertically">
                      <div class="card is-main is-chart is-grown-vertically">
                        <div class="card-header">
                          <h2 class="card-title">주 근무시간</h2>
                        </div>
                        <section class="card-body">
                          <p class="card-description">
                            <span class="card-description-item">
                              <span id="workMonth">4</span>월
                              <span id="workWeek">3</span>주
                            </span>
                            <span id="workSumHour" class="card-description-number" style="color: #359dff">42</span>
                            <span class="card-description-unit">h</span>
                          </p>
                          <div id="line-chart-0"></div>
                        </section>
                      </div>
                    </div>

                    <div class="column is-half is-grown-vertically">
                      <div class="card is-main is-chart is-grown-vertically">
                        <div class="card-header">
                          <h2 class="card-title">월 근무시간</h2>
                        </div>
                        <section class="card-body">
                          <p class="card-description">
                            <span class="card-description-item">
                              <span id="monthHour">126</span> / <span id="totalMonthHour">160</span>h
                            </span>
                            <span id="monthRate" class="card-description-number" style="color: #00d5a2">75</span>
                            <span class="card-description-unit">%</span>
                          </p>
                          <div id="bar-chart-0"></div>
                        </section>
                      </div>
                    </div>
                  </div>
                </div>

                <div class="column is-half is-grown-vertically">
                  <div class="card is-main is-horizontal">
                    <div class="card-header">
                      <h2 class="card-title">연차</h2>
                    </div>
                    <section class="card-body">
                      <div class="columns has-gap is-wrapped">
                        <div class="column">
                          <div class="inner-card">
                            <h3 class="inner-card-title">부여</h3>
                            <p class="inner-card-description" id="leaveDaysYear">15</p>
                          </div>
                        </div>
                        <div class="column">
                          <div class="inner-card">
                            <h3 class="inner-card-title">사용</h3>
                            <p class="inner-card-description" id="useDays">5</p>
                          </div>
                        </div>
                        <div class="column">
                          <div class="inner-card">
                            <h3 class="inner-card-title">잔여</h3>
                            <p class="inner-card-description" style="color: #359dff" id="remindDays">
                              10</p>
                          </div>
                        </div>
                      </div>
                    </section>
                    <a class="button is-more is-ghost" href="javascript:pageMdiTabNoParamOpen('/empmenu/wrkleav/wrklvestatusemp100/view')">
                      <span class="icon is-chevron-right"><svg><use href="#chevron-right"></use></svg></span>
                    </a>
                  </div>
                </div>

              </div>
            </div>
          </div>
        </div>
        <!-- 7(E) -->

        <div id="myModal" class="my-modal">
          <div class="my-modal-content">
            <span class="my-close">&times;</span>
            <h1 class="page-title" id="myModalTitle">제조기록서 작성</h1>
            <br/>
            <div id="list_3Grid"></div>
          </div>
        </div>

        <div id="confirmModal" class="my-modal">
          <div class="my-modal-content modal-no-height">
            <span class="my-close">&times;</span>
            <h1 class="page-title" id="confirmTitle">개정이력</h1>
            <br/>
            <div class="card-body">
              <table class="table is-search is-fullwidth">
                <colgroup>
                  <col style="width: 9%;"/>
                  <col style="width: 9%;"/>
                  <col/>
                </colgroup>
                <tbody>
                <tr>
                  <th><span>개정번호</span></th>
                  <td></td>
                  <td>
                    <input type="text" class="input"/>
                  </td>
                </tr>
                <tr>
                  <th><span>개정일자</span></th>
                  <td></td>
                  <td>
                    <input type="text" class="input"/>
                  </td>
                </tr>
                <tr>
                  <th><span>개정이력</span></th>
                  <td></td>
                  <td>
                    <input type="text" class="input"/>
                  </td>
                </tr>
                </tbody>
              </table>
              <button id="confirmModalWrite" type="button" class="button is-outline is-primary is-medium" style="margin-right: 10px;">
                제조기록서 작성
              </button>
            </div>
          </div>
        </div>
        <!-- 메인 페이지 끝... -->
      </div>
    </div>
  </div>
</div>

<script th:inline="javascript">

  let nowEnable = false;    //테이블 resize 현재값
  let tinyHeight = 500;
  let listGrid;
  let list_2Grid;
  let list_3Grid;
  let writeIdx = 0;

  let documentList = {
    'content_1': {
      idx: 'content_1',
      content: content_1,
      docName: '제조지시 및 기록서',
      prodName: '홍삼정 (Cage 추출방식)',
      process: '원료투입',
      worker: '홍길동',
      workDate: '2025-03-19',
      _attributes: {className: {column: {docName: ['chan-blue']}}}
    }
    ,
    'content_2': {
      idx: 'content_2',
      content: content_2,
      docName: '제조지시 및 기록서',
      prodName: '홍삼정',
      process: '충전',
      worker: '홍길동',
      workDate: '2025-03-19',
      _attributes: {className: {column: {docName: ['chan-blue']}}}
    }
    ,
    'content_3': {
      idx: 'content_3',
      content: content_3,
      docName: '포장지시 및 기록서',
      prodName: '홍삼정',
      process: '포장',
      worker: '홍길동',
      workDate: '2025-03-19',
      _attributes: {className: {column: {docName: ['chan-blue']}}}
    }
  };
  let writeList = {};

  let nowDetailContent;   //상세페이지에서 사용되는 content
  let nowDetailLocation;  //상세페이지 호출 경로

  $(document).ready(function () {
    // setSvg();
    initEvent();
    fn_getChart([8, 9, 9, 8, 8], ['월', '화', '수', '목', '금'], 126);
  })  //document.ready

  function initEvent() {
    //GNB
    $("#headerMenu .navbar-item").click(function () {
      $("#headerMenu .navbar-item").removeClass("is-active");

      // 클릭한 li에 is-active 추가
      $(this).addClass("is-active");
      if ($(this).data('target') == 'dom') {
        $("#sideMenuCom").hide();
        $("#sideMenuFav").hide();
        $("#sideMenuDoc").show();
      } else if ($(this).data('target') == 'com') {
        $("#sideMenuDoc").hide();
        $("#sideMenuFav").hide();
        $("#sideMenuCom").show();
      }
    });

    //LNB
    $("ul.menu .menu-item").click(function () {
      let isAlreadyActive = $(this).hasClass('is-active');
      if (!isAlreadyActive) {
        $(".sub-menu-item").removeClass('is-active');
        $("ul.menu .menu-item").removeClass('is-active');
        $(this).addClass('is-active');
      }
    });

    //LNB
    $("ul.menu .menu-item .sub-menu .sub-menu-item").click(function () {
      let isAlreadyActive = $(this).hasClass('is-active');
      if (!isAlreadyActive) {
        $(".sub-menu-item").removeClass('is-active');
        $(this).addClass('is-active');
      }
    });

    //LNB(접고 펼치기)
    $('.lnb-toggle-btn').click(function () {
      $(this).toggleClass('is-active');
      $('.left-navbar').toggleClass('is-active');
    });

    $('.navbar-left').click(function () {
      $(".left-navbar, .lnb-toggle-btn").addClass("is-active");
    })

    if ($(window).width() <= 1600) {
      tinyHeight = '64vh';
      $(".left-navbar, .lnb-toggle-btn").removeClass("is-active");

      const closeNavbar = () => {
        if ($(".left-navbar").hasClass("is-active") && $(".lnb-toggle-btn").hasClass("is-active")) {
          $(".left-navbar, .lnb-toggle-btn").removeClass("is-active");
        }
      };

      $("#mainContent, iframe").click(closeNavbar);
    }

    //TABS(메뉴/즐겨찾기)
    $("ul.tabs .tab").click(function () {
      $("ul.tabs .tab").removeClass('is-active');
      $(this).addClass('is-active');

      if ($(this).data('target') == 'base') {
        let gnb = $("#headerMenu .navbar-item.is-active").data("target");
        if (gnb && gnb == 'dom') {
          $("#sideMenuCom").hide();
          $("#sideMenuFav").hide();
          $("#sideMenuDoc").show();
        } else if (gnb && gnb == 'com') {
          $("#sideMenuDoc").hide();
          $("#sideMenuFav").hide();
          $("#sideMenuCom").show();
        } else {
          $("#sideMenuDoc").hide();
          $("#sideMenuFav").hide();
          $("#sideMenuCom").hide();
        }
      } else if ($(this).data('target') == 'fav') {
        $("#sideMenuDoc").hide();
        $("#sideMenuCom").hide();
        $("#sideMenuFav").show();
      }
    });

    $("#btnWrite").click(() => {
      if (confirm('저장하시겠습니까?')) {
        writeIdx++;
        writeList['writeContent_' + writeIdx] = {
          idx: 'writeContent_' + writeIdx
          , content: tinymce.get('writeTiny').getContent()
          , docName: documentList[nowDetailContent].docName
          , prodName: documentList[nowDetailContent].prodName
          , process: documentList[nowDetailContent].process
          , worker: '홍길동'
          , workDate: new Date().toLocaleDateString('en-CA')
          , _attributes: {className: {column: {docName: ['chan-blue']}}}
        }
        ;
        alert('저장되었습니다.');
        loadPage('list');



        const content = tinymce.get('writeTiny').getContent();

        // SmartDoc.WorkDocument.save({
        //   docNo: 'DOC-001',
        //   productName: '홍삼정',
        //   lotNo: 'A001-23',
        //   lotUnit: 'UNIT-01',
        //   workDate: new Date().toISOString().slice(0, 10),
        //   processName: '충전',
        //   content: content,
        //   writerId: 'testId',
        //   writerIp: '127.0.0.1',
        //   status: 'SAVED'
        // }, function (res) {
        //   alert('저장되었습니다.');
        //   loadPage('list');
        // });
      }
    });

    $("#btnWriteUpdate").click(() => {
      if (confirm('수정하시겠습니까?')) {
        writeList[nowDetailContent] = {
          idx: nowDetailContent
          , content: tinymce.get('writeTiny').getContent()
          , docName: writeList[nowDetailContent].docName
          , prodName: writeList[nowDetailContent].prodName
          , process: writeList[nowDetailContent].process
          , worker: '홍길동'
          , workDate: new Date().toLocaleDateString('en-CA')
          , _attributes: {className: {column: {docName: ['chan-blue']}}}
        }
        ;
        alert('수정되었습니다.');
        loadPage('list');
      }
    });

    $("#btnListWrite").click(() => {
      setList_3Grid();
      $("#myModal").fadeIn();
    });

    $("#btnUpdate").click(() => {
      $("#confirmModal").fadeIn();

      // if (confirm('수정하시겠습니까?')) {
      //   alert('수정되었습니다.');
      //   documentList[nowDetailContent].content = tinymce.get('updateTiny').getContent();
      //   loadPage('formList');
      // }
    });

    $("#confirmModalWrite").click(() => {
      if (confirm('수정하시겠습니까?')) {
        SmartDoc.DocumentMaster.save({
          idx: nowDetailContent,
          workDate: new Date().toISOString().slice(0, 10),
          content: tinymce.get('updateTiny').getContent(),
          regId: 'system',
          regIp: '127.0.0.1'
        }, function (res) {
          alert('수정되었습니다.');
          $("#confirmModal").fadeOut();
          loadPage('formList');
        });
      }
    });

    $("#btnDetailWrite").click(() => {
      //TODO 완
      let idx = nowDetailContent;
      if (nowDetailContent) {
        nowDetailLocation = 'listUpdate';
        SmartDoc.DocumentMaster.load(idx, function(res) {
          loadPage('write', res.content);
        });
      }
    });

    $("#btnDetailUpdate").click(() => {
      //TODO 완
      let idx = nowDetailContent;
      if (nowDetailContent) {
        SmartDoc.DocumentMaster.load(idx, function(res) {
          loadPage('update', res.content);
        });
      }
    });

    $(".my-close, .my-modal").click(function (event) {
      if (event.target === this) {
        $("#myModal").fadeOut();
        if (list_3Grid) {
          list_3Grid.destroy();
          list_3Grid = null;
        }

        $("#confirmModal").fadeOut();
      }
    });

    $("#searchFormListForm").on('click', function() {
      SmartDoc.DocumentMaster.getList({
        processName: $("#formListProcessName").val()
        , lotNo: $("#formListLotNo").val()
        , productName: $("#formListProductName").val()
      }, function(res) {
        res.forEach(item => {
          item.regDt = formatDate(item.regDt);
          item._attributes = {
            className: {
              column: {
                docName: ['chan-blue']
              }
            }
          };
        });

        if (list_2Grid) {
          list_2Grid.resetData(res);
        }
      });
    });

    $("#btnDownPdf").click(() => {
      var printContents = $("#detailTiny").html();
      let printWindow = window.open("", "_blank"); // 새 창 열기

      printWindow.document.write(`
        <html>
        <head>
            <title>PDF다운</title>
            <style>
                body { font-family: Arial, sans-serif; text-align: center; }
                #print-area { width: 100%; }
            </style>
        </head>
        <body>
            <div id="print-area">${printContents}</div>
            <script>
                window.onload = function() {
                    window.print();

                    // 인쇄 완료 후 창 닫기
                    window.onafterprint = function() { window.close(); };

                    // 인쇄 취소 감지 (matchMedia 활용)
                    var mediaQueryList = window.matchMedia('print');
                    mediaQueryList.addEventListener('change', function(e) {
                        if (!e.matches) {
                            window.close();
                        }
                    });

                    // 2초마다 창이 닫혔는지 확인 후 강제 닫기
                    var checkClose = setInterval(function() {
                        if (window.closed) {
                            clearInterval(checkClose);
                        } else {
                            window.close();
                        }
                    }, 500);
                };
            <\/script>
        </body>
        </html>
    `);

      printWindow.document.close();
    });

  } //initEvent

  function loadPage(type, content) {

    $("#listForm, #emptyForm, #updateForm, #writeForm, #detailForm, #formListForm, #mainForm").fadeOut(300).promise().done(function () {
      $("input").val('');
      destroyTiny();
      destroyGrid();

      if (type === 'list') {
        nowDetailContent = '';
        nowDetailLocation = '';
        $("#listGridCnt").text(Object.keys(writeList).length);
        setListGrid();
        $("#listForm").fadeIn(300);
      } else if (type === 'formList') {
        nowDetailContent = '';
        nowDetailLocation = '';
        setList_2Grid();
        $("#formListForm").fadeIn(300);
      } else if (type === 'write') {
        setTinyMce('writeTiny').then(() => {
          if (content) tinymce.get('writeTiny').setContent(content);
          if (nowDetailLocation === 'listUpdate') {
            $("#writeFormTitle").text('제조기록서 수정');
            $("#btnWriteUpdate").show();
            $("#btnWrite").hide();
          } else if (nowDetailLocation === 'newWrite') {
            $("#writeFormTitle").text('제조기록서 작성');
            $("#btnWrite").show();
            $("#btnWriteUpdate").hide();
          } else {
            $("#writeFormTitle").text('제조기록서 작성');
            $("#btnWrite").hide();
            $("#btnWriteUpdate").hide();
          }
          $("#writeForm").fadeIn(300);
        });
      } else if (type === 'update') {
        setTinyMce('updateTiny').then(() => {
          if (content) tinymce.get('updateTiny').setContent(content);
        });
        $("#updateForm").fadeIn(300);
      } else if (type === 'detail') {
        $("#detailTiny").html(content);
        if (nowDetailLocation === 'form') {
          $("#detailTitle").text('제조기록서 양식 상세');
          $("#detailListBread").hide();
          $("#btnDetailWrite").hide();
          $("#detailFormBread").show();
          $("#btnDetailUpdate").show();
        } else if (nowDetailLocation === 'list') {
          $("#detailTitle").text('제조기록서 상세');
          $("#detailFormBread").hide();
          $("#btnDetailUpdate").hide();
          $("#detailListBread").show();
          $("#btnDetailWrite").show();
        } else {
          $("#detailTitle").text('제조기록서 상세');
          $("#detailFormBread").hide();
          $("#btnDetailUpdate").hide();
          $("#btnDetailWrite").hide();
          $("#detailListBread").show();
        }
        $(".custom-radio").css("pointer-events", "none");
        $("#detailForm").fadeIn(300);
      } else if (type === 'none') {
        nowDetailContent = '';
        nowDetailLocation = '';
        $("#headerMenu .navbar-item, .menu-item").removeClass("is-active");
        $("#mainForm").fadeIn(300);
      } else {
        nowDetailContent = '';
        nowDetailLocation = '';
        $("#emptyTitle").text(type);
        $("#emptyForm").fadeIn(300);
      }
    });
  } //loadPage

  function destroyTiny(targetTiny) {
    if (targetTiny) {
      let editor = tinymce.get(editorId); // 현재 에디터 가져오기
      editor.setContent('');
      editor.destroy(); // 현재 에디터 제거
    } else {
      if (tinymce.get().length > 0) tinymce.get().forEach(editor => {
        editor.setContent('');
        editor.destroy();
      });
    }
  }

  function destroyGrid() {
    if (listGrid) {
      listGrid.destroy();
      listGrid = null;
    }
    if (list_2Grid) {
      list_2Grid.destroy();
      list_2Grid = null;
    }
  }

  function setTinyMce(tag) {
    return new Promise((resolve, reject) => {
      try {
        if (tag === 'writeTiny') {
          setWriterTiny(tag).then(resolve);
        } else {
          setManagerTiny(tag).then(resolve);
        }
      } catch (error) {
        reject(error);
      }
    });
  } //setTinyMce

  function toggleTableResize(editorId) {
    let editor = tinymce.get(editorId); // 현재 에디터 가져오기

    if (editor) {
      let tempContent = editor.getContent();
      editor.destroy(); // 현재 에디터 제거
      setManagerTiny(editorId).then(() => tinymce.get(editorId).setContent(tempContent));
    }
  } //toggleTableResize

  function setManagerTiny(tag) {
    return new Promise((resolve, reject) => {
      try {
        tinymce.init({
          selector: '#' + tag,
          language: 'ko_KR',
          resize: true,
          min_height: 500,
          height: tinyHeight,
          branding: false,
          elementpath: false,
          plugins: [
            'anchor', 'charmap', 'emoticons', 'link', 'lists', 'searchreplace', 'table', 'wordcount',
            'checklist', 'formatpainter', 'permanentpen', 'powerpaste', 'advtable', 'advcode', 'editimage', 'tableofcontents', 'inlinecss', 'markdown', 'importword', 'exportpdf'
          ]
          ,
          toolbar: ['blocks fontfamily fontsize | bold italic underline strikethrough | link table', 'align lineheight | checklist numlist bullist indent outdent | emoticons charmap | writeButton | resizeButton | makeRadioButton | setImageArea']
          ,
          content_style: `.myClass {border: 2px solid red !important;} .myImage {border: 2px solid green !important; cursor: pointer !important; -webkit-user-modify: read-only;}`
          ,
          table_resize_bars: nowEnable
          ,
          setup: (editor) => {
            editor.ui.registry.addButton('writeButton', {
              text: '작성설정'
              , onAction: (_) => {
                let node = editor.selection.getNode();
                let depth = 0;  // 최대 4단계 제한

                while (node && node.tagName && node.tagName.toLowerCase() !== "td" && depth < 5) {
                  node = node.parentNode;
                  depth++;
                }

                if (node && node.tagName && node.tagName.toLowerCase() === "td") {
                  if (node.classList.contains('myClass')) {
                    node.classList.remove("myClass");
                    node.classList.remove("customEdit");
                  } else {
                    node.classList.add("myClass");
                    node.classList.add("customEdit");
                  }
                } else {
                  if (editor.selection.getNode().classList.contains('myClass')) {
                    editor.selection.getNode().classList.remove('myClass');
                    editor.selection.getNode().classList.remove('customEdit');
                  } else {
                    editor.selection.getNode().classList.add('myClass');
                    editor.selection.getNode().classList.add('customEdit');
                  }
                }
              }
            });
            editor.ui.registry.addButton('resizeButton', {
              text: '테이블조절'
              , onAction: (_) => {
                nowEnable = !nowEnable;
                toggleTableResize(tag);
              }
            });
            editor.ui.registry.addButton('makeRadioButton', {
              text: '체크활성화'
              , onAction: (_) => {
                let content = editor.getContent();

                content = content.replace(/(<span[^>]*>)(.*?□.*?)(<\/span>)/g, function (match, p1, p2, p3) {
                  // □를 <input type="checkbox">로 변환
                  let checkbox = p2.replaceAll('□', '<input type="checkbox" class="custom-radio" style="margin: 0; vertical-align: bottom; width: 15px; height: 15px;"/>');
                  return p1 + checkbox + p3;
                });

                editor.setContent(content); // 변경된 내용 반영
              }
            });
            editor.ui.registry.addButton('setImageArea', {
              text: '이미지영역'
              , onAction: (_) => {
                let node = editor.selection.getNode();
                let depth = 0;  // 최대 4단계 제한

                while (node && node.tagName && node.tagName.toLowerCase() !== "td" && depth < 5) {
                  node = node.parentNode;
                  depth++;
                }

                if (node && node.tagName && node.tagName.toLowerCase() === "td") {
                  if (node.classList.contains('myImage')) {
                    node.classList.remove("myImage");
                    node.classList.remove("customEdit");

                    let tdInput = node.querySelector('input');
                    let tdImg = node.querySelector('img');
                    if (tdInput) {
                      node.removeChild(tdInput);
                    }
                    if (tdImg) {
                      node.removeChild(tdImg);
                    }
                  } else {
                    const $td = $(node);

                    // 1. id 생성
                    let maxId = 0;
                    $('[id^="customImage_"]').each(function () {
                      const idNum = parseInt(this.id.split('_')[1]);
                      if (!isNaN(idNum) && idNum > maxId) maxId = idNum;
                    });

                    const newId = `customImage_${maxId + 1}`;
                    $td.addClass('myImage').addClass('customEdit').attr('id', newId);

                    let tdInput = node.querySelector('input');
                    let tdImg = node.querySelector('img');
                    if (!tdInput) {
                      // input 태그 생성
                      tdInput = document.createElement('input');
                      tdInput.type = 'file';
                      tdInput.accept = 'image/*';
                      tdInput.style.display = 'none';
                      tdInput.id = `input_${newId}`;
                      node.appendChild(tdInput);
                    }
                    if (!tdImg) {
                      tdImg = document.createElement('img');
                      tdImg.src = 'img/svg/folder-opened.svg';
                      tdImg.alt = '';
                      tdImg.style.display = 'block';
                      tdImg.style.maxWidth = '100%';
                      tdImg.style.maxHeight = '100%';
                      tdImg.style.objectFit = 'contain';
                      tdImg.style.margin = '3px';
                      tdImg.style.justifySelf = 'center';
                      node.appendChild(tdImg);
                    }
                  }
                }
              }
            });
            editor.on('init', () => {
              editor.getBody().addEventListener('click', (event) => {
                if (event.target.tagName === 'INPUT' && event.target.type === 'checkbox' && event.target.classList.contains('custom-radio')) {
                  let checkbox = event.target;
                  let parentP = $(checkbox).closest('td');
                  let tobeCheckboxProp = $(checkbox).prop('checked');

                  // 해당 <p> 태그 내의 모든 .custom-radio를 uncheck 상태로 만들기
                  parentP.find('.custom-radio').prop('checked', false);
                  parentP.find('.custom-radio').removeAttr('checked');

                  $(checkbox).prop('checked', tobeCheckboxProp);
                  if (tobeCheckboxProp) $(checkbox).attr('checked', 'checked');
                  else $(checkbox).removeAttr('checked');
                }

                if ((event.target.tagName === 'TD' && event.target.classList.contains('myImage'))
                  || (event.target.closest('td') && event.target.closest('td').classList.contains('myImage'))) {
                  const tdId = event.target.closest('td').id;
                  const td = event.target.closest('td');
                  const input = event.target.closest('td').querySelector('input');

                  if (input) {
                    let fileChange = function (e) {
                      const file = e.target.files[0];
                      if (file) {
                        const reader = new FileReader();
                        reader.onload = function (event) {
                          const oldInput = td.querySelector('input');
                          let img = td.querySelector('img');

                          if (!img) {
                            img = document.createElement('img');
                            img.src = event.target.result;
                            img.setAttribute("data-mce-src", event.target.result);
                            img.alt = '썸네일';
                            img.style.display = 'block';
                            img.style.maxWidth = '100%';
                            img.style.maxHeight = '100%';
                            img.style.objectFit = 'contain';
                            img.style.margin = '3px';
                            td.appendChild(img);
                          } else {
                            // 이미 존재하는 img는 src만 업데이트
                            img.src = event.target.result;
                            img.setAttribute("data-mce-src", event.target.result);
                            img.style.display = 'block';
                          }

                        };
                        reader.readAsDataURL(file);
                      }
                    }

                    input.removeEventListener('change', fileChange);
                    input.addEventListener('change', fileChange);
                    input.click();
                  }
                }
              });
            })
          }
          ,
          init_instance_callback: (e) => resolve()
        });
      } catch (e) {
        reject(e);
      }

    });
  } //setManagerTiny

  function setWriterTiny(tag) {
    return new Promise((resolve, reject) => {
      try {
        tinymce.init({
          selector: '#' + tag
          ,
          language: 'ko_KR'
          ,
          resize: true
          ,
          menubar: false
          ,
          toolbar: false
          ,
          editable_class: 'customEdit'
          ,
          editable_root: false
          ,
          content_style: `.myClass {border: 2px solid red !important;} .myImage {border: 2px solid green !important; cursor: pointer !important; -webkit-user-modify: read-only;}`
          ,
          min_height: 500
          ,
          height: tinyHeight
          ,
          branding: false
          ,
          elementpath: false
          ,
          setup: (editor) => {
            editor.on('init', () => {
              editor.getBody().addEventListener('click', (event) => {
                if (event.target.tagName === 'INPUT' && event.target.type === 'checkbox' && event.target.classList.contains('custom-radio')) {
                  let checkbox = event.target;
                  let parentP = $(checkbox).closest('td');
                  let tobeCheckboxProp = $(checkbox).prop('checked');

                  // 해당 <p> 태그 내의 모든 .custom-radio를 uncheck 상태로 만들기
                  parentP.find('.custom-radio').prop('checked', false);
                  parentP.find('.custom-radio').removeAttr('checked');

                  $(checkbox).prop('checked', tobeCheckboxProp);
                  if (tobeCheckboxProp) $(checkbox).attr('checked', 'checked');
                  else $(checkbox).removeAttr('checked');
                }

                if ((event.target.tagName === 'TD' && event.target.classList.contains('myImage'))
                  || (event.target.closest('td') && event.target.closest('td').classList.contains('myImage'))) {
                  const tdId = event.target.closest('td').id;
                  const td = event.target.closest('td');
                  const input = event.target.closest('td').querySelector('input');

                  if (input) {
                    let fileChange = function (e) {
                      const file = e.target.files[0];
                      if (file) {
                        const reader = new FileReader();
                        reader.onload = function (event) {
                          const oldInput = td.querySelector('input');
                          let img = td.querySelector('img');

                          if (!img) {
                            img = document.createElement('img');
                            img.src = event.target.result;
                            img.setAttribute("data-mce-src", event.target.result);
                            img.alt = '썸네일';
                            img.style.display = 'block';
                            img.style.maxWidth = '100%';
                            img.style.maxHeight = '100%';
                            img.style.objectFit = 'contain';
                            img.style.margin = '3px';
                            td.appendChild(img);
                          } else {
                            // 이미 존재하는 img는 src만 업데이트
                            img.src = event.target.result;
                            img.setAttribute("data-mce-src", event.target.result);
                            img.style.display = 'block';
                          }

                        };
                        reader.readAsDataURL(file);
                      }
                    }

                    input.removeEventListener('change', fileChange);
                    input.addEventListener('change', fileChange);
                    input.click();
                  }
                }
              })
            })
          }
          ,
          init_instance_callback: (e) => resolve()
        });
      } catch (error) {
        reject(error);
      }
    });
  } //setWriterTiny

  function setListGrid() {
    if (listGrid) return;
    // tui.Grid.applyTheme('striped');
    setGridStyle_a();
    listGrid = new tui.Grid({
      el: document.getElementById('listGrid')
      , data: Object.values(writeList)
      , scrollX: false
      , scrollY: false
      , bodyHeight: 300
      , rowHeight: 35
      , rowHeaders: ['rowNum']
      , columns: [
        {header: 'content값', name: 'idx', hidden: true}
        , {header: '제조기록서', name: 'docName', sortable: true, align: 'center'}
        , {header: '제품명', name: 'prodName', sortable: true}
        , {header: '제조공정', name: 'process', sortable: true}
        , {header: '작업자', name: 'worker', sortable: true, align: 'center'}
        , {header: '작업일자', name: 'workDate', sortable: true, align: 'center'}
      ]
      , contextMenu: ({rowKey, columnName}) => [
        [{
          name: 'export',
          label: 'Export'
          ,
          subMenu: [{
            name: 'execlExport',
            label: '엑셀내보내기(xlsx)',
            action: () => listGrid.export('xlsx', {fileName: '제조기록서_리스트'})
          }]
        }]
      ]
    });

    listGrid.on('click', (ev) => {
      if (ev.columnName === 'docName') {
        let idx = listGrid.getValue(ev.rowKey, "idx");
        if (idx) {
          nowDetailContent = idx;
          nowDetailLocation = 'list';
          loadPage('detail', writeList[idx].content);
        }
      }
    })
  }

  function formatDate(isoString) {
    if (!isoString) return '';
    const date = new Date(isoString);
    const yyyy = date.getFullYear();
    const mm = String(date.getMonth() + 1).padStart(2, '0'); // 월은 0부터 시작
    const dd = String(date.getDate()).padStart(2, '0');
    return `${yyyy}-${mm}-${dd}`;
  }

  function setList_2Grid() {
    //TODO 완
    if (list_2Grid) return;

    SmartDoc.DocumentMaster.getList({}, function(res) {
      console.log("res :: ", res);
      setGridStyle_a();

      res.forEach(item => {
        item.regDt = formatDate(item.regDt); // 새 필드로 저장
        item._attributes = {
          className: {
            column: {
              docName: ['chan-blue']
            }
          }
        };
      });

      list_2Grid = new tui.Grid({
        el: document.getElementById('list_2Grid')
        , data: res
        , scrollX: false
        , scrollY: false
        , bodyHeight: 300
        , rowHeight: 35
        , rowHeaders: ['rowNum']
        , columns: [
          {header: 'idx', name: 'idx', hidden: true}
          , {header: '문서번호', name: 'docNo', sortable: true, align: 'center'}
          , {header: '문서이름', name: 'docName', sortable: true, align: 'center'}
          , {header: '제품명', name: 'productName', sortable: true}
          , {header: '제조번호', name: 'lotNo', sortable: true}
          , {header: '제조단위', name: 'lotUnit', sortable: true}
          , {header: '제조공정', name: 'processName', sortable: true}
          , {header: '등록자', name: 'regId', sortable: true, align: 'center'}
          , {header: '등록일자', name: 'regDt', sortable: true, align: 'center'}
          , {header: 'content', name: 'content', hidden: true}
        ]
        , contextMenu: ({rowKey, columnName}) => [
          [{
            name: 'export',
            label: 'Export'
            ,
            subMenu: [{
              name: 'execlExport',
              label: '엑셀내보내기(xlsx)',
              action: () => list_2Grid.export('xlsx', {fileName: '제조기록서양식_리스트'})
            }]
          }]
        ]
      });

      list_2Grid.on('click', (ev) => {
        if (ev.columnName === 'docName') {
          let idx = list_2Grid.getValue(ev.rowKey, "idx");
          if (idx) {
            nowDetailContent = idx;
            nowDetailLocation = 'form';
            SmartDoc.DocumentMaster.load(idx, function(res) {
              loadPage('detail', res.content);
            });
          }
        }
      });
    });
  }

  function setList_3Grid() {
    if (list_3Grid) return;
    setGridStyle_a();

    list_3Grid = new tui.Grid({
      el: document.getElementById('list_3Grid')
      , data: Object.values(documentList)
      , scrollX: false
      , scrollY: false
      , bodyHeight: 300
      , rowHeight: 35
      , rowHeaders: ['rowNum']
      , columns: [
        {header: 'content값', name: 'idx', hidden: true}
        , {header: '제조기록서', name: 'docName', sortable: true, align: 'center'}
        , {header: '제품명', name: 'prodName', sortable: true}
        , {header: '제조공정', name: 'process', sortable: true}
      ]
    });

    list_3Grid.on('click', (ev) => {
      if (ev.columnName === 'docName') {
        let idx = list_3Grid.getValue(ev.rowKey, "idx");
        if (idx) {
          nowDetailContent = idx;
          nowDetailLocation = 'newWrite';
          $("#myModal").fadeOut();
          loadPage('write', documentList[idx].content);
          list_3Grid.destroy();
          list_3Grid = null;
        }
      }
    })
  }

  function setGridStyle_a() {
    tui.Grid.applyTheme('striped', {
      selection: {
        background: '#4daaf9',
        border: '#004082'
      },
      scrollbar: {
        background: '#f5f5f5',
        thumb: '#d9d9d9',
        active: '#c1c1c1'
      },
      row: {
        even: {
          background: '#f8f8f8'
        },
        hover: {
          background: '#eee'
        }
      },
      cell: {
        normal: {
          background: '#fbfbfb',
          border: '#e0e0e0',
          showVerticalBorder: true
        },
        header: {
          background: '#eee',
          border: '#ccc',
          showVerticalBorder: true
        },
        rowHeader: {
          border: '#ccc',
          showVerticalBorder: true
        },
        editable: {
          background: '#fbfbfb'
        },
        selectedHeader: {
          background: '#d8d8d8'
        },
        focused: {
          border: '#418ed4'
        },
        disabled: {
          text: '#b0b0b0'
        }
      }
    });
  }


  function fn_getChart(linedata0, linelank0, bardata0) {
    //차트 초기화..
    $("#line-chart-0").empty();
    $("#bar-chart-0").empty();

    // line chart
    let lineData = [];
    let lineOptions = [];
    let lineCharts = [];

    lineData[0] = {
      categories: ['월', '화', '수', '목', '금', '토', '일'],
      series: [
        {
          name: '일근무',
          data: linedata0
        }
      ]
    };

    lineOptions[0] = {
      xAxis: {
        pointOnColumn: true
      },
      yAxis: {
        scale: {
          min: 0,
          max: 16,
          stepSize: 4
        }
      },
      legend: {
        visible: false
      },
      plot: {
        bands: [
          {
            range: [
              linelank0,
            ],
            color: '#00bcd4',
            opacity: 0.2,
          },
        ],
      },
      exportMenu: {
        visible: false
      },
      series: {
        showDot: true,
        selectable: true,
        dataLabels: {
          visible: true,
        }
      },
      theme: {
        xAxis: {
          color: "white",
          label: {
            color: "white"
          }
        },
        yAxis: {
          label: {
            fontFamily: "Pretendard",
            fontSize: 13,
            fontWeight: 400,
            color: "#666"
          },
          color: "white"
        },
        series: {
          dot: {
            radius: 3,
            borderWidth: 2,
            borderColor: "white"
          },
          lineWidth: 3,
          colors: ["#359DFF"],
          dataLabels: {
            fontFamily: 'Impact',
            fontSize: 13,
            fontWeight: 500,
            color: '#ff416d',
            textBubble: {visible: true, arrow: {visible: true}},
          }
        }
      }
    };

    lineCharts[0] = Chart.lineChart({
      el: document.querySelector("#line-chart-0"),
      data: lineData[0],
      options: lineOptions[0]
    });

    // bar chart
    let barData = [];
    let barOptions = [];
    let barCharts = [];

    barData[0] = {
      categories: [0],
      series: [
        {
          name: "월 근무시간",
          data: [bardata0]
        }
      ]
    };

    barOptions[0] = {
      xAxis: {
        scale: {
          min: 0,
          max: 200,
          stepSize: 50
        }
      },
      legend: {
        visible: false
      },
      exportMenu: {
        visible: false
      },
      series: {
        selectable: true,
        dataLabels: {
          visible: true,
        },
      },
      theme: {
        xAxis: {
          label: {
            fontFamily: "Pretendard",
            fontSize: 13,
            fontWeight: 400,
            color: "#666"
          },
          color: "white"
        },
        yAxis: {
          label: {
            color: "white"
          },
          color: "white"
        },
        series: {
          barWidth: 42,
          colors: ["#00D5A2"],
          dataLabels: {
            fontFamily: 'Impact',
            fontSize: 13,
            fontWeight: 500,
            color: '#ff416d',
            textBubble: {visible: true, arrow: {visible: true}},
          }
        }
      }
    };

    barCharts[0] = Chart.barChart({
      el: document.querySelector("#bar-chart-0"),
      data: barData[0],
      options: barOptions[0]
    });

  }

</script>
</body>

</html>